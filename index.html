<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVå¥³å„ªæ¤œç´¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï½œAPIè‡ªå‹•ç”»åƒå–å¾—ãƒ»åç›ŠåŒ–ç‰ˆ</title>
    <meta name="description" content="AVå¥³å„ªã‚’å¹´é½¢ãƒ»ã‚«ãƒƒãƒ—ã‚µã‚¤ã‚ºãƒ»èº«é•·ãƒ»ã‚¸ãƒ£ãƒ³ãƒ«ã§çµã‚Šè¾¼ã¿æ¤œç´¢ã§ãã‚‹ç·åˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€‚">

    <style>
        :root {
            --primary: #ff4081;
            --primary-dark: #c60055;
            --secondary: #f5f5f5;
            --text-main: #333;
            --text-light: #777;
            --bg-body: #f0f2f5;
            --card-radius: 12px;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        header h1 { margin: 0; font-size: 1.5rem; }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* æ¤œç´¢ãƒ‘ãƒãƒ« */
        .search-panel {
            background: white;
            padding: 20px;
            border-radius: var(--card-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .search-header {
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer; font-weight: bold; color: var(--primary);
        }

        .search-body {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px; margin-top: 15px;
        }

        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-size: 0.85rem; color: var(--text-light); margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="number"], select {
            padding: 10px; border: 1px solid #ddd; border-radius: 6px;
            font-size: 1rem; width: 100%; box-sizing: border-box;
        }

        .range-group { display: flex; align-items: center; gap: 5px; }
        .range-group span { color: var(--text-light); }

        /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ */
        .genre-group {
            grid-column: 1 / -1; display: flex; flex-wrap: wrap; gap: 10px;
            padding-top: 10px; border-top: 1px solid #eee;
        }

        .checkbox-label {
            display: flex; align-items: center; gap: 5px; font-size: 0.9rem;
            cursor: pointer; background: #f9f9f9; padding: 5px 10px;
            border-radius: 20px; border: 1px solid #eee; transition: all 0.2s;
        }

        .checkbox-label:hover { background: #ffebf0; border-color: var(--primary); }
        .checkbox-label input { accent-color: var(--primary); }

        /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒãƒ¼ */
        .control-bar {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 15px; flex-wrap: wrap; gap: 10px;
        }

        .result-count { font-weight: bold; color: var(--text-light); }
        .result-count span { color: var(--primary); font-size: 1.2rem; margin: 0 5px; }
        .sort-select { padding: 8px; border-radius: 6px; border: 1px solid #ddd; }

        /* ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ */
        .results-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 20px; }

        /* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .card {
            background: white; border-radius: var(--card-radius); box-shadow: var(--shadow);
            overflow: hidden; transition: transform 0.2s, box-shadow 0.2s;
            position: relative; display: flex; flex-direction: column;
        }

        .card:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.12); }

        .card-image-wrapper {
            position: relative; padding-top: 125%; background: #eee; overflow: hidden;
        }

        .card-image {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; transition: transform 0.3s;
        }
        
        .card:hover .card-image { transform: scale(1.05); }

        .cup-badge {
            position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7);
            color: #fff; width: 40px; height: 40px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.2rem; border: 2px solid var(--primary); z-index: 2;
        }

        .card-content { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-title { margin: 0 0 5px 0; font-size: 1.1rem; font-weight: bold; }
        .card-title a { text-decoration: none; color: var(--text-main); }
        .card-meta { font-size: 0.85rem; color: var(--text-light); margin-bottom: 10px; }

        .stats-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 5px; font-size: 0.85rem;
            background: #f8f8f8; padding: 8px; border-radius: 6px; margin-bottom: 10px;
        }

        .stats-item strong { color: var(--text-main); }
        .tag-container { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 15px; }
        .tag { font-size: 0.7rem; padding: 3px 8px; background: #ffeef4; color: var(--primary); border-radius: 4px; }

        .btn-link {
            display: block; margin-top: auto; background: var(--primary); color: white;
            text-align: center; padding: 10px; text-decoration: none; border-radius: 6px;
            font-weight: bold; transition: background 0.2s;
        }
        .btn-link:hover { background: var(--primary-dark); }

        /* è©³ç´°ãƒšãƒ¼ã‚¸ */
        .detail-view {
            background: white; padding: 30px; border-radius: var(--card-radius);
            box-shadow: var(--shadow); max-width: 800px; margin: 0 auto;
        }
        .detail-flex { display: flex; flex-wrap: wrap; gap: 30px; }
        .detail-img { flex: 1; min-width: 300px; }
        .detail-img img { width: 100%; border-radius: 8px; }
        .detail-info { flex: 1; min-width: 300px; }
        .detail-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .detail-table th, .detail-table td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; }
        .detail-table th { width: 30%; color: var(--text-light); }
        .back-btn { display: inline-block; margin-bottom: 20px; color: var(--text-light); text-decoration: none; }

        /* ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆã‚¯ãƒ¬ã‚¸ãƒƒãƒˆç”¨ï¼‰ */
        footer {
            text-align: center; padding: 30px 15px; color: #888; font-size: 0.85rem;
            margin-top: 40px; border-top: 1px solid #ddd;
        }
        footer a { color: #888; text-decoration: underline; }

        @media (max-width: 600px) {
            .search-body { grid-template-columns: 1fr 1fr; }
            .form-group:first-child { grid-column: 1 / -1; }
        }
    </style>
</head>
<body>

<header>
    <h1>AVå¥³å„ª æ¤œç´¢DB</h1>
</header>

<div class="container" id="mainContainer">
    <div class="search-panel">
        <div class="search-header" onclick="toggleSearch()">
            <span>ğŸ” çµã‚Šè¾¼ã¿æ¤œç´¢æ¡ä»¶</span>
            <span style="font-size:0.8rem; font-weight:normal; color:#888;">ã‚¿ãƒƒãƒ—ã—ã¦é–‹é–‰</span>
        </div>
        <div class="search-body" id="searchBody">
            <div class="form-group">
                <label>åå‰</label>
                <input type="text" id="filterName" placeholder="åå‰ã‚’å…¥åŠ›">
            </div>
            <div class="form-group">
                <label>å¹´é½¢</label>
                <div class="range-group">
                    <input type="number" id="filterAgeMin" placeholder="Min">
                    <span>ã€œ</span>
                    <input type="number" id="filterAgeMax" placeholder="Max">
                </div>
            </div>
            <div class="form-group">
                <label>èº«é•· (cm)</label>
                <div class="range-group">
                    <input type="number" id="filterHeightMin" placeholder="140">
                    <span>ã€œ</span>
                    <input type="number" id="filterHeightMax" placeholder="180">
                </div>
            </div>
            <div class="form-group">
                <label>ã‚«ãƒƒãƒ—</label>
                <select id="filterCup">
                    <option value="">æŒ‡å®šãªã—</option>
                    <option value="A">A</option><option value="B">B</option><option value="C">C</option>
                    <option value="D">D</option><option value="E">E</option><option value="F">F</option>
                    <option value="G">G</option><option value="H">H</option><option value="I">I</option>
                    <option value="J">Jä»¥ä¸Š</option>
                </select>
            </div>
            <div class="form-group">
                <label>ãƒã‚¹ãƒˆ (cm)</label>
                <div class="range-group">
                    <input type="number" id="filterBustMin" placeholder="Min">
                    <span>ã€œ</span>
                    <input type="number" id="filterBustMax" placeholder="Max">
                </div>
            </div>
            <div class="form-group">
                <label>ã‚¦ã‚¨ã‚¹ãƒˆ (cm)</label>
                <div class="range-group">
                    <input type="number" id="filterWaistMin" placeholder="Min">
                    <span>ã€œ</span>
                    <input type="number" id="filterWaistMax" placeholder="Max">
                </div>
            </div>
            <div class="form-group">
                <label>ãƒ’ãƒƒãƒ— (cm)</label>
                <div class="range-group">
                    <input type="number" id="filterHipMin" placeholder="Min">
                    <span>ã€œ</span>
                    <input type="number" id="filterHipMax" placeholder="Max">
                </div>
            </div>

            <div class="genre-group" id="genreContainer"></div>
            
            <div style="grid-column: 1 / -1; text-align: right;">
                <button onclick="resetFilters()" style="padding: 8px 16px; background:#ddd; border:none; border-radius:4px; cursor:pointer;">æ¡ä»¶ãƒªã‚»ãƒƒãƒˆ</button>
            </div>
        </div>
    </div>

    <div class="control-bar">
        <div class="result-count">è©²å½“: <span id="countDisplay">0</span>ä»¶</div>
        <select id="sortSelect" class="sort-select">
            <option value="default">ä¸¦ã³æ›¿ãˆ</option>
            <option value="age_asc">å¹´é½¢ãŒè‹¥ã„é †</option>
            <option value="age_desc">å¹´é½¢ãŒé«˜ã„é †</option>
            <option value="height_desc">èº«é•·ãŒé«˜ã„é †</option>
            <option value="height_asc">èº«é•·ãŒä½ã„é †</option>
            <option value="bust_desc">ãƒã‚¹ãƒˆãŒå¤§ãã„é †</option>
        </select>
    </div>

    <div class="results-grid" id="resultsContainer"></div>
</div>

<footer>
    Powered by <a href="https://affiliate.dmm.com/api/" target="_blank">DMM Webã‚µãƒ¼ãƒ“ã‚¹</a>
</footer>

<script>
    // ==========================================
    // ğŸš¨ ã“ã“ã‚’è‡ªåˆ†ã®IDã«æ›¸ãæ›ãˆã¦ãã ã•ã„ï¼ ğŸš¨
    // ==========================================
    const API_ID = "Qr42BeY54EnU1EpnVWwb";
    const AFF_ID = "eastjam-001";

    // ä¸€åº¦å–å¾—ã—ãŸç”»åƒã‚’ä¿å­˜ã—ã¦ãŠãã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆAPIã¸ã®éå‰°ã‚¢ã‚¯ã‚»ã‚¹ã‚’é˜²ããŸã‚ï¼‰
    const imageCache = {};

    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆé…åˆ—ã®é–‰ã˜ã‚«ãƒƒã‚³ã‚’ä¿®æ­£ã—ã¾ã—ãŸï¼‰
    const actressData = [
        { id: 10, name: "æ²³åŒ— å½©ä¼½", age: 26, cup: "E", bust: 88, waist: 57, hip: 86, height: 169, genre: ["å·¨ä¹³","äººæ°—", "ç¾å°‘å¥³", "ãƒ¢ãƒ‡ãƒ«"], imageURL: "https://placehold.co/400x500/e91e63/ffffff?text=Loading..." }
    ];

// ==========================================
Â  Â  // éåŒæœŸã§DMM APIã‹ã‚‰å¥³å„ªç”»åƒã¨å…¬å¼ãƒªãƒ³ã‚¯ã‚’å–å¾—ã™ã‚‹é–¢æ•°
Â  Â  // ==========================================
Â  Â  async function fetchActressImage(actressName, imgElement, linkContainerElement = null) {
Â  Â  Â  Â  if (imageCache[actressName]) {
Â  Â  Â  Â  Â  Â  imgElement.src = imageCache[actressName];
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  // APIã§æ¤œç´¢ãƒ’ãƒƒãƒˆã—ã‚„ã™ã„ã‚ˆã†ã«åå‰ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å»
Â  Â  Â  Â  Â  Â  const searchKeyword = actressName.replace(/\s+/g, "");
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // DMM APIã®URL
Â  Â  Â  Â  Â  Â  const dmmApiUrl = `https://api.dmm.com/affiliate/v3/ActressSearch?api_id=${API_ID}&affiliate_id=${AFF_ID}&keyword=${encodeURIComponent(searchKeyword)}&output=json`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // å¤‰æ›´ç‚¹ï¼šcorsproxy.ioã‹ã‚‰ã€æ¯”è¼ƒçš„å®‰å®šã—ã¦ã„ã‚‹ allorigins ã«å¤‰æ›´
Â  Â  Â  Â  Â  Â  const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(dmmApiUrl)}`;

Â  Â  Â  Â  Â  Â  const response = await fetch(proxyUrl);
Â  Â  Â  Â  Â  Â  if (!response.ok) throw new Error("ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ");
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const data = await response.json();

Â  Â  Â  Â  Â  Â  if (data && data.result && data.result.actress && data.result.actress.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  const actressInfo = data.result.actress[0];
Â  Â  Â  Â  Â  Â  Â  Â  const imageUrl = actressInfo.imageURL ? actressInfo.imageURL.large : null;
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if (imageUrl) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  imageCache[actressName] = imageUrl;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  imgElement.src = imageUrl;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ç”»åƒã®èª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã«å‚™ãˆãŸå‡¦ç†
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  imgElement.onerror = () => { imgElement.src = "https://placehold.co/400x500?text=No+Image"; };
Â  Â  Â  Â  Â  Â  Â  Â  } else {
                    imgElement.src = "https://placehold.co/400x500?text=No+Image";
                }

Â  Â  Â  Â  Â  Â  Â  Â  // DMM APIãŒç”Ÿæˆã—ãŸå…¬å¼ã®ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆURLãŒå­˜åœ¨ã™ã‚Œã°ã€ãƒœã‚¿ãƒ³ã®ãƒªãƒ³ã‚¯ã‚’ä¸Šæ›¸ãã™ã‚‹
Â  Â  Â  Â  Â  Â  Â  Â  if (linkContainerElement && actressInfo.listURL && actressInfo.listURL.digital) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const btn = linkContainerElement.querySelector('.btn-link');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (btn) btn.href = actressInfo.listURL.digital;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // å¥³å„ªãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ãƒ€ãƒŸãƒ¼ç”»åƒ
Â  Â  Â  Â  Â  Â  Â  Â  imgElement.src = "https://placehold.co/400x500?text=Not+Found";
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  console.error(`${actressName} ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:`, error);
Â  Â  Â  Â  Â  Â  imgElement.src = "https://placehold.co/400x500?text=Error";
Â  Â  Â  Â  }
Â  Â  }

    // --- åˆæœŸåŒ–å‡¦ç† ---
    const resultsContainer = document.getElementById('resultsContainer');
    const countDisplay = document.getElementById('countDisplay');
    const genreContainer = document.getElementById('genreContainer');
    
    // ã‚¸ãƒ£ãƒ³ãƒ«ç”Ÿæˆ
    const allGenres = [...new Set(actressData.flatMap(d => d.genre))].sort();
    allGenres.forEach(genre => {
        const label = document.createElement('label');
        label.className = 'checkbox-label';
        label.innerHTML = `<input type="checkbox" value="${genre}" class="filter-genre"> ${genre}`;
        genreContainer.appendChild(label);
    });

    const inputs = {
        name: document.getElementById('filterName'),
        ageMin: document.getElementById('filterAgeMin'), ageMax: document.getElementById('filterAgeMax'),
        heightMin: document.getElementById('filterHeightMin'), heightMax: document.getElementById('filterHeightMax'),
        cup: document.getElementById('filterCup'),
        bustMin: document.getElementById('filterBustMin'), bustMax: document.getElementById('filterBustMax'),
        waistMin: document.getElementById('filterWaistMin'), waistMax: document.getElementById('filterWaistMax'),
        hipMin: document.getElementById('filterHipMin'), hipMax: document.getElementById('filterHipMax'),
        sort: document.getElementById('sortSelect')
    };
    const genreInputs = document.getElementsByClassName('filter-genre');

    // --- ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° & ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° ---
    function filterAndRender() {
        const nameVal = inputs.name.value.toLowerCase().trim().replace(/\s+/g, "");
        const ageMin = parseInt(inputs.ageMin.value) || 0;
        const ageMax = parseInt(inputs.ageMax.value) || 100;
        const heightMin = parseInt(inputs.heightMin.value) || 0;
        const heightMax = parseInt(inputs.heightMax.value) || 300;
        const cupVal = inputs.cup.value;
        const bustMin = parseInt(inputs.bustMin.value) || 0;
        const bustMax = parseInt(inputs.bustMax.value) || 200;
        const waistMin = parseInt(inputs.waistMin.value) || 0;
        const waistMax = parseInt(inputs.waistMax.value) || 200;
        const hipMin = parseInt(inputs.hipMin.value) || 0;
        const hipMax = parseInt(inputs.hipMax.value) || 200;
        const selectedGenres = Array.from(genreInputs).filter(cb => cb.checked).map(cb => cb.value);

        let filtered = actressData.filter(item => {
            const normalizeName = item.name.toLowerCase().replace(/\s+/g, "");
            if (nameVal && !normalizeName.includes(nameVal)) return false;
            if (item.age < ageMin || item.age > ageMax) return false;
            if (item.height < heightMin || item.height > heightMax) return false;
            if (item.bust && (item.bust < bustMin || item.bust > bustMax)) return false;
            if (item.waist && (item.waist < waistMin || item.waist > waistMax)) return false;
            if (item.hip && (item.hip < hipMin || item.hip > hipMax)) return false;

            if (cupVal) {
                if (cupVal === 'J') {
                    if (item.cup < 'J') return false;
                } else {
                    if (item.cup !== cupVal) return false;
                }
            }

            if (selectedGenres.length > 0) {
                if (!selectedGenres.some(g => item.genre.includes(g))) return false;
            }
            return true;
        });

        const sortMode = inputs.sort.value;
        if (sortMode !== 'default') {
            filtered.sort((a, b) => {
                switch(sortMode) {
                    case 'age_asc': return a.age - b.age;
                    case 'age_desc': return b.age - a.age;
                    case 'height_desc': return b.height - a.height;
                    case 'height_asc': return a.height - b.height;
                    case 'bust_desc': return (b.bust || 0) - (a.bust || 0);
                    default: return 0;
                }
            });
        }

        renderGrid(filtered);
    }

    function renderGrid(data) {
        resultsContainer.innerHTML = '';
        countDisplay.textContent = data.length;

        if (data.length === 0) {
            resultsContainer.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:40px; color:#888;">æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹å¥³å„ªã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</div>';
            return;
        }

        data.forEach(item => {
            const card = document.createElement('div');
            card.className = 'card';
            const tags = item.genre.map(g => `<span class="tag">${g}</span>`).join('');
            const cupBadge = item.cup ? `<div class="cup-badge">${item.cup}</div>` : '';

            // äºˆå‚™ã®æ‰‹å‹•ç”Ÿæˆãƒªãƒ³ã‚¯ï¼ˆAPIé€šä¿¡å‰ã«ä»®ã§ã‚»ãƒƒãƒˆã—ã¦ãŠãï¼‰
            const searchUrl = `https://www.dmm.co.jp/digital/videoa/-/list/=/searchstr=${item.name.replace(/\s+/g,"")}`;
            const affiliateLink = `https://al.dmm.co.jp/?lurl=${encodeURIComponent(searchUrl)}&af_id=${AFF_ID}`;

            card.innerHTML = `
                <a href="?id=${item.id}" style="text-decoration:none; color:inherit;">
                    <div class="card-image-wrapper">
                        ${cupBadge}
                        <img src="${item.imageURL}" alt="${item.name}" class="card-image" id="img-${item.id}" loading="lazy">
                    </div>
                    <div class="card-content">
                        <h2 class="card-title">${item.name}</h2>
                        <div class="card-meta">${item.age}æ­³ / T${item.height}cm</div>
                        <div class="stats-grid">
                            <div class="stats-item">B: <strong>${item.bust || '-'}</strong></div>
                            <div class="stats-item">W: <strong>${item.waist || '-'}</strong></div>
                            <div class="stats-item">H: <strong>${item.hip || '-'}</strong></div>
                            <div class="stats-item">Cup: <strong>${item.cup || '-'}</strong></div>
                        </div>
                        <div class="tag-container">${tags}</div>
                    </div>
                </a>
                <div style="padding:0 15px 15px 15px;" class="link-container">
                    <a href="${affiliateLink}" target="_blank" class="btn-link">FANZAã§æ¢ã™</a>
                </div>
            `;
            resultsContainer.appendChild(card);

            // APIã‚’å©ã„ã¦æœ¬ç‰©ã®ç”»åƒã‚’å–å¾—ã—ã€ã¤ã„ã§ã«ãƒœã‚¿ãƒ³ã®ãƒªãƒ³ã‚¯ã‚‚å…¬å¼ã®ã‚‚ã®ã«å·®ã—æ›¿ãˆã‚‹
            const imgElement = card.querySelector(`#img-${item.id}`);
            const linkContainer = card.querySelector('.link-container');
            fetchActressImage(item.name, imgElement, linkContainer);
        });
    }

    Object.values(inputs).forEach(input => {
        input.addEventListener('input', filterAndRender);
        input.addEventListener('change', filterAndRender);
    });
    Array.from(genreInputs).forEach(cb => cb.addEventListener('change', filterAndRender));

    window.resetFilters = function() {
        document.querySelectorAll('input').forEach(i => {
            if(i.type === 'checkbox') i.checked = false;
            else i.value = '';
        });
        document.getElementById('filterCup').value = '';
        document.getElementById('sortSelect').value = 'default';
        filterAndRender();
    };

    window.toggleSearch = function() {
        const body = document.getElementById('searchBody');
        body.style.display = body.style.display === 'none' ? 'grid' : 'none';
    };
    
    // --- è©³ç´°ãƒšãƒ¼ã‚¸ ---
    const urlParams = new URLSearchParams(window.location.search);
    const detailId = urlParams.get('id');

    if (detailId) {
        const target = actressData.find(a => a.id == detailId);
        if (target) {
            const searchUrl = `https://www.dmm.co.jp/digital/videoa/-/list/=/searchstr=${target.name.replace(/\s+/g,"")}`;
            const affiliateLink = `https://al.dmm.co.jp/?lurl=${encodeURIComponent(searchUrl)}&af_id=${AFF_ID}`;

            document.getElementById('mainContainer').innerHTML = `
                <a href="./" class="back-btn">â† ä¸€è¦§ã«æˆ»ã‚‹</a>
                <div class="detail-view">
                    <h1 style="margin-top:0;">${target.name} <small style="font-size:0.6em; color:#777;">(${target.age}æ­³)</small></h1>
                    <div class="detail-flex">
                        <div class="detail-img">
                            <img src="${target.imageURL}" alt="${target.name}" id="detail-img-${target.id}">
                        </div>
                        <div class="detail-info">
                            <div class="tag-container">
                                ${target.genre.map(g => `<span class="tag" style="font-size:0.9rem; padding:5px 10px;">${g}</span>`).join('')}
                            </div>
                            <table class="detail-table">
                                <tr><th>èº«é•·</th><td>${target.height} cm</td></tr>
                                <tr><th>ãƒã‚¹ãƒˆ</th><td>${target.bust} cm (${target.cup}ã‚«ãƒƒãƒ—)</td></tr>
                                <tr><th>ã‚¦ã‚¨ã‚¹ãƒˆ</th><td>${target.waist} cm</td></tr>
                                <tr><th>ãƒ’ãƒƒãƒ—</th><td>${target.hip} cm</td></tr>
                            </table>
                            <div class="link-container" style="margin-top: 20px;">
                                <a href="${affiliateLink}" target="_blank" class="btn-link">FANZAã§ä½œå“ã‚’è¦‹ã‚‹</a>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.title = `${target.name} ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« | AVå¥³å„ªDB`;

            // è©³ç´°ãƒšãƒ¼ã‚¸ã§ã‚‚ç”»åƒã‚’APIã‹ã‚‰å–å¾—ã—ã€ãƒªãƒ³ã‚¯ã‚’å…¬å¼ã®ã‚‚ã®ã«å·®ã—æ›¿ãˆ
            const imgElement = document.getElementById(`detail-img-${target.id}`);
            const linkContainer = document.querySelector('.link-container');
            fetchActressImage(target.name, imgElement, linkContainer);
        }
    } else {
        filterAndRender();
    }
</script>
</body>
</html>
